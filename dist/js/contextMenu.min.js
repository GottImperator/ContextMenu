!function(t,e){"use strict";function n(i){!function(t,e){function n(i){this.$element=i,e.FeatherNest(this.$element,"context"),this.type=this.$element.attr("data-context-menu")||void 0,this.options=t.extend({},n.prototype.config,this._getConfig()),this._init(),this._bindEvents(),e.registerPlugin(this)}n.prototype.config={single:!0,accessible:!0,touchdelay:400,screenOffset:10},n.prototype._init=function(){this.$menu=0===this.type.indexOf("#")?t(this.type):this._getMenu(),this._render()},n.prototype._render=function(){this.$menu.hide().appendTo(t("body")),new e.DropdownMenu(this.$menu)},n.prototype._getConfig=function(){return this.config[this.type]},n.prototype.addConfig=function(t,e){n.prototype.config[t]=e},n.prototype._getMenu=function(e){var e=e||this.options.structure,n=t('<ul class="context menu dropdown vertical"></ul>');for(var i in e){var o=t("<li></li>");if(e[i]["class"]&&o.addClass(e[i]["class"]),e[i].icon&&(o.append('<span class="icon '+e[i].icon+'"></span>'),e[i].help&&o.append("<small>"+e[i].help+"</small>")),e[i].text&&(o.append('<span class="text">'+e[i].text+"</span>"),e[i].help&&o.append("<small>"+e[i].help+"</small>")),e[i].href&&o.click(function(){location.href=e[i].href}),e[i].click&&o.click(e[i].click),e[i].href&&o.attr({"data-href":e[i].href}),e[i].children){o.addClass("has-submenu");var s=this._getMenu(e[i].children);s.addClass("submenu").appendTo(o)}this.options.accessible&&(e[i].children||e[i].href||e[i].click)&&o.attr({tabindex:0}),n.append(o)}return n},n.prototype._bindEvents=function(){var e,n=this;this.$element.on("contextmenu touchstart",function(t){t.preventDefault(),t.stopPropagation(),"touchstart"===t.type?e=setTimeout(function(){n.show(t)},n.options.touchdelay):n.show(t)}).on("touchend",function(t){e&&clearTimeout(e)}),t("body").on("click touchstart",function(e){!n.open||t(e.target).is(n.$menu.add(t(n.$menu.find("*"))))||t(e.target).is(n.$element)&&3===e.button&&"touchstart"!==e.type||n.hide()}),this.$element.find("[data-context-menu-trigger]").click(function(t){t.stopPropagation(),n.show(),n.$menu.attr({tabindex:"-1"}).focus()})},n.prototype.show=function(e){var n,i;if(e&&"contextmenu"===e.type){var e=e||window.event;n=e.pageX||e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=e.pageY||e.clientY+document.body.scrollTop+document.documentElement.scrollTop}else n=this.$element.offset().left+this.$element.outerWidth(),i=this.$element.offset().top;this.$menu.css("visibility","hidden").show(),n+this.$menu.outerWidth()>t(window).outerWidth()&&(n=t(window).outerWidth()-this.$menu.outerWidth()-this.options.screenOffset),this.$menu.css({top:i,left:n}),this.options.single&&t("body").trigger("click"),this.$menu.css("visibility",""),this.open=!0},n.prototype.hide=function(t){this.$menu.hide(),this.open=!1},e.plugin(n)}(jQuery,window.Foundation),this.$element=i,e.FeatherNest(this.$element,"context"),this.type=this.$element.attr("data-context-menu")||void 0,this.options=t.extend({},n.prototype.config,this._getConfig()),this._init(),this._bindEvents(),e.registerPlugin(this)}n.prototype.config={single:!0,accessible:!0,touchdelay:400,screenOffset:10},n.prototype._init=function(){this.$menu=0===this.type.indexOf("#")?t(this.type):this._getMenu(),this._render()},n.prototype._render=function(){this.$menu.hide().appendTo(t("body")),new e.DropdownMenu(this.$menu)},n.prototype._getConfig=function(){return this.config[this.type]},n.prototype.addConfig=function(t,e){n.prototype.config[t]=e},n.prototype._getMenu=function(e){var e=e||this.options.structure,n=t('<ul class="context menu dropdown vertical"></ul>');for(var i in e){var o=t("<li></li>");if(e[i]["class"]&&o.addClass(e[i]["class"]),e[i].icon&&(o.append('<span class="icon '+e[i].icon+'"></span>'),e[i].help&&o.append("<small>"+e[i].help+"</small>")),e[i].text&&(o.append('<span class="text">'+e[i].text+"</span>"),e[i].help&&o.append("<small>"+e[i].help+"</small>")),e[i].href&&o.click(function(){location.href=e[i].href}),e[i].click&&o.click(e[i].click),e[i].href&&o.attr({"data-href":e[i].href}),e[i].children){o.addClass("has-submenu");var s=this._getMenu(e[i].children);s.addClass("submenu").appendTo(o)}this.options.accessible&&(e[i].children||e[i].href||e[i].click)&&o.attr({tabindex:0}),n.append(o)}return n},n.prototype._bindEvents=function(){var e,n=this;this.$element.on("contextmenu touchstart",function(t){t.preventDefault(),t.stopPropagation(),"touchstart"===t.type?e=setTimeout(function(){n.show(t)},n.options.touchdelay):n.show(t)}).on("touchend",function(t){e&&clearTimeout(e)}),t("body").on("click touchstart",function(e){!n.open||t(e.target).is(n.$menu.add(t(n.$menu.find("*"))))||t(e.target).is(n.$element)&&3===e.button&&"touchstart"!==e.type||n.hide()}),this.$element.find("[data-context-menu-trigger]").click(function(t){t.stopPropagation(),n.show(),n.$menu.attr({tabindex:"-1"}).focus()})},n.prototype.show=function(e){var n,i;if(e&&"contextmenu"===e.type){var e=e||window.event;n=e.pageX||e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=e.pageY||e.clientY+document.body.scrollTop+document.documentElement.scrollTop}else n=this.$element.offset().left+this.$element.outerWidth(),i=this.$element.offset().top;this.$menu.css("visibility","hidden").show(),n+this.$menu.outerWidth()>t(window).outerWidth()&&(n=t(window).outerWidth()-this.$menu.outerWidth()-this.options.screenOffset),this.$menu.css({top:i,left:n}),this.options.single&&t("body").trigger("click"),this.$menu.css("visibility",""),this.open=!0},n.prototype.hide=function(t){this.$menu.hide(),this.open=!1},e.plugin(n)}(jQuery,window.Foundation);